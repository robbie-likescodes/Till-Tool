<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Daily Close â€” Barista Web App</title>
  <link rel="stylesheet" href="styles.css" />
  <meta name="theme-color" content="#7C3AED" />
</head>
<body>
  <div class="wrap">
    <h1>Daily Close</h1>
    <div class="sub">Pick shift â†’ scan receipts â†’ (optional) review â†’ add denominations â†’ submit.</div>

    <!-- HEADER / IDENTITY -->
    <div class="card grid grid-2-md">
      <div>
        <label>First name</label>
        <div class="field"><input id="firstName" type="text" autocomplete="given-name" placeholder="e.g., Ava"></div>
      </div>
      <div>
        <label>Last name</label>
        <div class="field"><input id="lastName" type="text" autocomplete="family-name" placeholder="e.g., Lee"></div>
      </div>

      <div>
        <label>Store</label>
        <div class="field">
          <select id="store">
            <option value="">Choose locationâ€¦</option>
            <option>Huffman</option>
            <option>Boniface</option>
            <option>Muldoon</option>
            <option>Lake Otis</option>
            <option>Camelot</option>
          </select>
        </div>
        <div class="hint">Remembered on this device.</div>
      </div>

      <div class="grid grid-2">
        <div>
          <label>Date</label>
          <div class="field"><input id="date" type="date"></div>
        </div>
        <div>
          <label>Time</label>
          <div class="field"><input id="time" type="time" step="60"></div>
        </div>
      </div>

      <div>
        <label>Shift</label>
        <div class="row">
          <label class="chip"><input type="radio" name="shift" id="shiftAM" checked> AM</label>
          <label class="chip"><input type="radio" name="shift" id="shiftPM"> PM</label>
        </div>
        <div class="hint">Auto-picks by time; you can override.</div>
      </div>
    </div>

    <!-- CAMERA TIPS (optional tiny helper) -->
    <div class="tip">
      ðŸ“¸ <strong>Best scan:</strong> flat receipt â€¢ no glare â€¢ fill the frame â€¢ use back camera.
    </div>

    <!-- AM MODE -->
    <section id="amMode">
      <!-- AM SALES -->
      <div class="card">
        <div class="sect-title">
          <h2>AM Sales Report</h2>
          <span id="amSalesChip" class="badge">waiting</span>
        </div>
        <div class="row">
          <input id="fileAmSales" type="file" accept="image/*" capture="environment" />
          <button id="btnScanAmSales" class="btn btn-grad tiny" type="button">Scan AM Sales</button>
          <span id="statusAmSales" class="pill">Idle</span>
        </div>

        <!-- Summary (editable; just the payment/tips block) -->
        <div class="grid grid-2-md mt-12">
          <div><label>Total Collected</label><div class="field"><input id="am_total_collected" type="number" step="0.01" inputmode="decimal"></div></div>
          <div><label>Tips</label><div class="field"><input id="am_tips" type="number" step="0.01" inputmode="decimal"></div></div>
          <div><label>Card</label><div class="field"><input id="am_card" type="number" step="0.01" inputmode="decimal"></div></div>
          <div><label>Cash</label><div class="field"><input id="am_cash" type="number" step="0.01" inputmode="decimal"></div></div>
          <div><label>Gift Card</label><div class="field"><input id="am_gift_card" type="number" step="0.01" inputmode="decimal"></div></div>
        </div>

        <!-- Full mirror of the receipt (optional review) -->
        <details id="amSalesDetails" class="mt-12">
          <summary class="pill">Review scanned details (optional)</summary>
          <div id="amSalesMirror" class="grid grid-2-md mt-12"></div>
        </details>
      </div>

      <!-- AM DRAWER (exactly mirrors the receiptâ€™s 5 fields) -->
      <div class="card">
        <div class="sect-title">
          <h2>AM Drawer Report</h2>
          <span id="amDrawerChip" class="badge">waiting</span>
        </div>
        <div class="row">
          <input id="fileAmDrawer" type="file" accept="image/*" capture="environment" />
          <button id="btnScanAmDrawer" class="btn btn-grad tiny" type="button">Scan AM Drawer</button>
          <span id="statusAmDrawer" class="pill">Idle</span>
        </div>

        <div class="grid grid-2-md mt-12">
          <div><label>Starting Cash</label><div class="field"><input id="am_starting_cash" type="number" step="0.01" inputmode="decimal"></div></div>
          <div><label>Cash Sales</label><div class="field"><input id="am_cash_sales_drawer" type="number" step="0.01" inputmode="decimal"></div></div>
          <div><label>Cash Refunds</label><div class="field"><input id="am_cash_refunds" type="number" step="0.01" inputmode="decimal"></div></div>
          <div><label>Paid In/Out</label><div class="field"><input id="am_paid_in_out" type="number" step="0.01" inputmode="decimal"></div></div>
          <div><label>Expected in Drawer</label><div class="field"><input id="am_expected_in_drawer" type="number" step="0.01" inputmode="decimal"></div></div>
        </div>

        <details id="amDrawerDetails" class="mt-12">
          <summary class="pill">Review scanned drawer details (optional)</summary>
          <div id="amDrawerMirror" class="grid grid-2-md mt-12"></div>
        </details>
      </div>

      <!-- AM EXTRAS -->
      <div class="card">
        <div class="sect-title"><h2>AM Manual Extras</h2><span class="badge">optional</span></div>
        <div class="grid grid-3-md">
          <div><label>Expenses</label><div class="field"><input id="am_expenses" type="number" step="0.01" inputmode="decimal"></div></div>
        </div>
      </div>

      <!-- AM DEPOSIT -->
      <div class="card">
        <div class="sect-title"><h2>AM Deposit (manual)</h2></div>
        <div class="grid grid-3-md">
          <div><label>Coins</label><div class="field"><input id="am_dep_coins" type="number" step="0.01"></div></div>
          <div><label>$1s</label><div class="field"><input id="am_dep_1s" type="number" step="0.01"></div></div>
          <div><label>$5s</label><div class="field"><input id="am_dep_5s" type="number" step="0.01"></div></div>
          <div><label>$10s</label><div class="field"><input id="am_dep_10s" type="number" step="0.01"></div></div>
          <div><label>$20s</label><div class="field"><input id="am_dep_20s" type="number" step="0.01"></div></div>
          <div><label>$50s</label><div class="field"><input id="am_dep_50s" type="number" step="0.01"></div></div>
          <div><label>$100s</label><div class="field"><input id="am_dep_100s" type="number" step="0.01"></div></div>
          <div><label>Deposit Total (auto)</label><div class="field"><input id="am_cash_deposit_total" type="number" readonly></div></div>
        </div>
      </div>

      <!-- AM COMPUTED -->
      <div class="card">
        <div class="sect-title"><h2>AM Computed</h2><span id="amCalcChip" class="badge">â€¦</span></div>
        <div class="grid grid-3-md">
          <div><label>AM Shift Total (Card + Deposit)</label><div class="field"><input id="am_shift_total" type="number" readonly></div></div>
          <div><label>AM Sales Total (Actual)</label><div class="field"><input id="am_sales_total" type="number" readonly></div></div>
          <div><label>AM Mishandled Cash</label><div class="field"><input id="am_mishandled_cash" type="number" readonly></div></div>
        </div>
      </div>
    </section>

    <!-- PM MODE -->
    <section id="pmMode" style="display:none">
      <!-- PM SALES (requires AM + PM scans, or manual entry) -->
      <div class="card">
        <div class="sect-title">
          <h2>PM Sales Reports</h2>
          <span id="pmSalesChip" class="badge">waiting</span>
        </div>

        <div class="grid grid-2-md">
          <div>
            <label>Scan AM Sales (earlier shift)</label>
            <div class="row">
              <input id="filePmAmSales" type="file" accept="image/*" capture="environment" />
              <button id="btnScanPmAmSales" class="btn btn-grad tiny" type="button">Scan AM Sales</button>
              <span id="statusPmAm" class="pill">Idle</span>
            </div>
          </div>
          <div>
            <label>Scan PM Sales (your shift)</label>
            <div class="row">
              <input id="filePmSales" type="file" accept="image/*" capture="environment" />
              <button id="btnScanPmSales" class="btn btn-grad tiny" type="button">Scan PM Sales</button>
              <span id="statusPmSales" class="pill">Idle</span>
            </div>
          </div>
        </div>

        <!-- PM summary -->
        <div class="grid grid-2-md mt-12">
          <div><label>PM Total Collected</label><div class="field"><input id="pm_total_collected" type="number" step="0.01"></div></div>
          <div><label>PM Tips</label><div class="field"><input id="pm_tips" type="number" step="0.01"></div></div>
          <div><label>PM Card</label><div class="field"><input id="pm_card" type="number" step="0.01"></div></div>
          <div><label>PM Cash</label><div class="field"><input id="pm_cash" type="number" step="0.01"></div></div>
          <div><label>PM Gift Card</label><div class="field"><input id="pm_gift_card" type="number" step="0.01"></div></div>
        </div>

        <details id="pmAmMirrorDetails" class="mt-12">
          <summary class="pill">Review scanned AM details (optional)</summary>
          <div id="pmAmSalesMirror" class="grid grid-2-md mt-12"></div>
        </details>
        <details id="pmSalesDetails" class="mt-12">
          <summary class="pill">Review scanned PM details (optional)</summary>
          <div id="pmSalesMirror" class="grid grid-2-md mt-12"></div>
        </details>
      </div>

      <!-- PM DRAWER (exact 5 fields) -->
      <div class="card">
        <div class="sect-title">
          <h2>PM Drawer Report</h2>
          <span id="pmDrawerChip" class="badge">waiting</span>
        </div>
        <div class="row">
          <input id="filePmDrawer" type="file" accept="image/*" capture="environment" />
          <button id="btnScanPmDrawer" class="btn btn-grad tiny" type="button">Scan PM Drawer</button>
          <span id="statusPmDrawer" class="pill">Idle</span>
        </div>

        <div class="grid grid-2-md mt-12">
          <div><label>Starting Cash</label><div class="field"><input id="pm_starting_cash" type="number" step="0.01" inputmode="decimal"></div></div>
          <div><label>Cash Sales</label><div class="field"><input id="pm_cash_sales_drawer" type="number" step="0.01" inputmode="decimal"></div></div>
          <div><label>Cash Refunds</label><div class="field"><input id="pm_cash_refunds" type="number" step="0.01" inputmode="decimal"></div></div>
          <div><label>Paid In/Out</label><div class="field"><input id="pm_paid_in_out" type="number" step="0.01" inputmode="decimal"></div></div>
          <div><label>Expected in Drawer</label><div class="field"><input id="pm_expected_in_drawer" type="number" step="0.01" inputmode="decimal"></div></div>
        </div>

        <details id="pmDrawerDetails" class="mt-12">
          <summary class="pill">Review scanned PM drawer (optional)</summary>
          <div id="pmDrawerMirror" class="grid grid-2-md mt-12"></div>
        </details>
      </div>

      <!-- PM EXTRAS -->
      <div class="card">
        <div class="sect-title"><h2>PM Manual Extras</h2><span class="badge">optional</span></div>
        <div class="grid grid-3-md">
          <div><label>Expenses</label><div class="field"><input id="pm_expenses" type="number" step="0.01" inputmode="decimal"></div></div>
        </div>
      </div>

      <!-- PM DEPOSIT -->
      <div class="card">
        <div class="sect-title"><h2>PM Deposit (manual)</h2></div>
        <div class="grid grid-3-md">
          <div><label>Coins</label><div class="field"><input id="pm_dep_coins" type="number" step="0.01"></div></div>
          <div><label>$1s</label><div class="field"><input id="pm_dep_1s" type="number" step="0.01"></div></div>
          <div><label>$5s</label><div class="field"><input id="pm_dep_5s" type="number" step="0.01"></div></div>
          <div><label>$10s</label><div class="field"><input id="pm_dep_10s" type="number" step="0.01"></div></div>
          <div><label>$20s</label><div class="field"><input id="pm_dep_20s" type="number" step="0.01"></div></div>
          <div><label>$50s</label><div class="field"><input id="pm_dep_50s" type="number" step="0.01"></div></div>
          <div><label>$100s</label><div class="field"><input id="pm_dep_100s" type="number" step="0.01"></div></div>
          <div><label>Deposit Total (auto)</label><div class="field"><input id="pm_cash_deposit_total" type="number" readonly></div></div>
        </div>
      </div>

      <!-- PM COMPUTED -->
      <div class="card">
        <div class="sect-title"><h2>PM Computed</h2><span id="pmCalcChip" class="badge">â€¦</span></div>
        <div class="grid grid-3-md">
          <div><label>PM Shift Total (Card + Deposit)</label><div class="field"><input id="pm_shift_total" type="number" readonly></div></div>
          <div><label>PM Sales Total (Actual)</label><div class="field"><input id="pm_sales_total" type="number" readonly></div></div>
          <div><label>PM Mishandled Cash</label><div class="field"><input id="pm_mishandled_cash" type="number" readonly></div></div>
        </div>
      </div>
    </section>
  </div>

  <!-- Sticky submit -->
  <div class="sticky">
    <div class="bar">
      <span id="saveHint" class="muted">Ready</span>
      <div class="row">
        <button id="recalcBtn" class="btn btn-ghost" type="button">Recalculate</button>
        <button id="submitBtn" class="btn btn-grad" type="button" disabled>Submit</button>
      </div>
    </div>
  </div>

  <!-- OCR libs: OpenCV first (for preprocessing), then Tesseract -->
  <script async src="https://docs.opencv.org/4.10.0/opencv.js"></script>
  <script src="https://unpkg.com/tesseract.js@5.0.5/dist/tesseract.min.js"></script>
  <!-- Your app code (does preprocessing + OCR + logic) -->
  <script src="app.js"></script>
</body>
</html>
